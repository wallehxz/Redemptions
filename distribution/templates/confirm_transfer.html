{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>确认收款</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
  <h3>您有一笔待确认转账</h3>
  <button id="btn" style="width:100%;height:48px;font-size:18px;color:#fff;background:#07c160;border:0;border-radius:4px;">确认收款</button>

  <!-- 微信 JS-SDK（JSBridge 已内置，无需额外引入） -->
  <script>
    document.getElementById('btn').addEventListener('click', function () {
      /* 判断当前环境是否微信 */
      if (typeof WeixinJSBridge === 'undefined') {
        alert('请在微信内打开！');
        return;
      }

      /* 官方文档示例参数 */
      WeixinJSBridge.invoke(
        'requestMerchantTransfer',
        {
          mchId: '{{ mch_id }}',
          appId: '{{ app_id }}',
          package: '{{ package_str }}'
        },
        function (res) {
          if (res.err_msg === 'requestMerchantTransfer:ok') {
            alert('已确认收款！');
          } else if (res.err_msg === 'requestMerchantTransfer:cancel') {
            alert('您已取消');
          } else {
            alert('调用失败：' + res.err_msg);
          }
        }
      );
    });
  </script>
</body>
</html>